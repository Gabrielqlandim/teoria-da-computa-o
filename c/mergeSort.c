#include <stdio.h>
#include <stdlib.h>
#include <time.h>

int vetor_fixo[100] = {
    5732, 9881, 4769, 1045, 8302, 2119, 6450, 3847, 9023, 7521,
    1478, 6264, 3159, 4901, 2816, 7334, 1650, 8397, 5720, 4213,
    9375, 2846, 6519, 1032, 4890, 7126, 3708, 5964, 8642, 2571,
    4389, 7002, 1298, 9645, 3024, 5170, 7458, 1987, 6834, 4312,
    9120, 2743, 5601, 1387, 7985, 3490, 6271, 4859, 9506, 2165,
    7543, 3298, 6821, 1409, 8765, 3987, 5231, 6712, 2506, 4903,
    3690, 7184, 1257, 8320, 2934, 6018, 7459, 1902, 6839, 4391,
    9103, 2784, 5587, 1359, 7964, 3485, 6259, 4832, 9485, 2123,
    7530, 3333, 6800, 1423, 8750, 3960, 5210, 6700, 2510, 4920,
    3712, 7200, 1270, 8340, 2945, 6030, 7465, 1920, 6850, 4400
};

int vetor_fixo2[1000] = {
        6297, 199, 8014, 3533, 1664, 7935, 1975, 5182, 7133, 2389,
        4954, 6266, 1497, 1142, 7454, 5561, 9116, 9935, 5244, 311,
        935, 1051, 8748, 711, 565, 492, 6239, 5157, 623, 4984,
        3858, 9190, 5107, 6800, 2677, 2498, 9817, 6710, 2782, 9142,
        2033, 3606, 3319, 9226, 5169, 1870, 9097, 6061, 7075, 6222,
        9458, 5370, 3900, 2150, 4218, 4695, 8491, 7576, 1372, 6730,
        9049, 2303, 274, 3797, 4264, 3414, 2884, 8665, 8580, 4716,
        1087, 5247, 1026, 3025, 8313, 6176, 2452, 2062, 2997, 9312,
        8964, 6739, 6836, 4328, 5176, 5989, 586, 1312, 3434, 6445,
        3662, 5976, 5090, 1228, 5715, 3478, 3692, 3506, 1822, 9039,
        9711, 2715, 3903, 8422, 9151, 8073, 1158, 796, 3430, 3351,
        9435, 1655, 5702, 4488, 9692, 734, 1400, 1143, 5286, 1986,
        6350, 6201, 154, 8707, 7150, 1222, 6240, 5411, 6305, 6331,
        4254, 2854, 562, 6306, 4330, 5472, 661, 8907, 2103, 2599,
        565, 5884, 9984, 9983, 5853, 7833, 9256, 6501, 2489, 5623,
        671, 6321, 3981, 8501, 3876, 6511, 9227, 6428, 7076, 7612,
        8102, 2045, 9311, 1236, 2088, 8612, 680, 3673, 1361, 1805,
        1046, 1869, 7822, 2191, 6174, 2704, 7752, 2230, 9407, 6136,
        7295, 328, 176, 7411, 534, 18, 8373, 8129, 564, 344,
        5340, 4256, 6645, 7457, 2840, 3838, 7591, 7423, 5769, 6350,
        4571, 393, 7054, 4035, 6880, 4054, 9327, 3943, 6432, 1593,
        1886, 2399, 6582, 8097, 4556, 9753, 6577, 6950, 9362, 9921,
        2399, 5001, 4869, 3876, 6927, 2074, 3585, 81, 3404, 4558,
        4474, 7239, 5959, 881, 7748, 9171, 5051, 2868, 5081, 2963,
        6751, 974, 2482, 8096, 507, 1109, 6430, 5052, 7163, 2643,
        1569, 8938, 8109, 4765, 7910, 1978, 7309, 846, 2630, 8680,
        8462, 350, 4212, 9133, 7937, 1640, 8633, 1007, 5775, 3600,
        6325, 9924, 9721, 6009, 5055, 2883, 8749, 8924, 7764, 1894,
        5448, 7948, 2128, 3666, 379, 5537, 5273, 478, 7246, 1489,
        7808, 190, 4884, 6964, 2629, 857, 1582, 9500, 8683, 3436,
        4698, 6410, 7258, 8425, 8053, 4962, 2093, 3876, 5128, 4196,
        4390, 7824, 8638, 1728, 155, 1035, 2816, 7625, 6523, 6815,
        9693, 1076, 4181, 6434, 7737, 9695, 1444, 466, 9281, 844,
        6627, 8945, 7758, 736, 2501, 8713, 9653, 8384, 9500, 7571,
        758, 8724, 2781, 2984, 4321, 7533, 4320, 2722, 819, 2482,
        9396, 9043, 5882, 819, 4385, 7983, 1812, 8997, 5714, 2265,
        1467, 8966, 6762, 3990, 1770, 9559, 9694, 331, 8125, 4858,
        8202, 3187, 7930, 7627, 7880, 5119, 7518, 9161, 2492, 8674,
        4221, 2377, 9660, 3113, 7029, 6018, 2038, 2845, 7459, 4312,
        9267, 7387, 1749, 8314, 1876, 4873, 1634, 2461, 2962, 445,
        8983, 2834, 7988, 5193, 7983, 7073, 6560, 3687, 1851, 334,
        9776, 8266, 8394, 7894, 3643, 4935, 3471, 9896, 6821, 6648,
        7538, 2658, 6264, 7627, 6962, 3054, 4876, 9819, 1864, 2601,
        3715, 252, 1954, 6679, 3353, 7889, 2688, 8280, 5541, 4485,
        1102, 815, 5670, 9690, 6341, 6184, 5240, 7533, 6110, 7910,
        5590, 2001, 4592, 5632, 2270, 3314, 1959, 8962, 8766, 8446,
        7971, 8508, 8901, 4942, 9799, 3258, 82, 9048, 1202, 3155,
        834, 9448, 7066, 6527, 550, 7807, 8904, 2447, 550, 532,
        2017, 4835, 3535, 2841, 4907, 5440, 5476, 1888, 9842, 5046,
        9406, 2871, 8830, 8297, 7859, 5645, 6847, 9030, 7964, 9306,
        4811, 3853, 8177, 3260, 7147, 1733, 2415, 8680, 9676, 5738,
        9274, 8527, 1416, 3886, 2369, 2757, 1991, 7352, 7170, 8862,
        8155, 6831, 6723, 7577, 2549, 8074, 8811, 8778, 9453, 5361,
        3536, 5142, 6367, 1825, 5036, 4591, 6240, 9216, 9109, 371,
        6972, 9944, 7709, 8559, 8561, 6200, 5280, 2734, 157, 1033,
        9943, 7998, 9400, 7676, 9002, 488, 5891, 7435, 9660, 9271,
        8584, 3369, 5747, 6687, 6054, 4609, 7191, 2277, 4770, 464,
        1566, 25, 3629, 9233, 3441, 4880, 6244, 2041, 5460, 6604,
        7019, 1970, 1281, 6366, 9717, 3254, 4169, 4006, 1463, 5620,
        3422, 8540, 3566, 5939, 97, 9359, 5823, 1164, 2680, 599,
        8912, 1781, 2350, 5390, 4870, 9091, 5946, 4182, 7050, 9812,
        8260, 8098, 8311, 8882, 3589, 1627, 4741, 8404, 4391, 1494,
        6909, 376, 7601, 5990, 598, 4501, 6813, 7405, 382, 2027,
        9656, 2517, 161, 17, 3543, 5178, 5447, 9829, 9445, 677,
        4272, 6933, 4674, 2130, 9680, 4520, 2642, 6971, 6003, 8667,
        1562, 5264, 4877, 3477, 5270, 706, 5015, 6991, 9661, 6735,
        8428, 2519, 9973, 902, 2517, 4467, 7087, 2505, 5397, 9274,
        8016, 6101, 7295, 7907, 27, 1245, 3856, 5568, 3477, 2359,
        6546, 3348, 7581, 3133, 1401, 9904, 5288, 5327, 1231, 7568,
        5743, 2548, 3637, 7253, 6218, 6446, 7603, 6700, 7765, 5469,
        5437, 7894, 1152, 901, 7785, 7811, 8215, 3413, 3237, 674,
        9378, 9555, 5132, 530, 1934, 9058, 2606, 1451, 801, 2923,
        7223, 1883, 4440, 8594, 2848, 1335, 6667, 6690, 3090, 217,
        5737, 3511, 9831, 9903, 5752, 4553, 6558, 3782, 8191, 4157,
        4071, 1625, 8564, 8460, 4708, 8300, 9624, 8651, 5915, 118,
        8288, 7921, 1553, 3184, 4032, 9156, 4923, 9253, 83, 1866,
        6074, 7105, 2006, 9649, 377, 901, 4236, 289, 2616, 8938,
        9488, 3484, 6, 2311, 2832, 3268, 3537, 1495, 6857, 1699,
        5339, 5698, 3373, 2688, 389, 3502, 3803, 2401, 9126, 1472,
        8981, 7293, 9585, 3835, 9520, 8943, 5542, 4004, 4575, 2750,
        6113, 5475, 7954, 194, 9393, 7258, 4456, 640, 1, 6848,
        3515, 4828, 7288, 9370, 9054, 3105, 2499, 7284, 6015, 5678,
        1007, 417, 9885, 3174, 1070, 298, 1144, 1284, 5560, 393,
        6482, 9881, 5297, 9120, 3068, 957, 8487, 8518, 156, 8916,
        7721, 8956, 9345, 3990, 2301, 2728, 983, 5861, 6998, 2521,
        2487, 5085, 6890, 4731, 3164, 3113, 7634, 9055, 563, 3751,
        4306, 5123, 9373, 2450, 4287, 6759, 2746, 6023, 344, 4412,
        8739, 3438, 9107, 3924, 3737, 4223, 2936, 872, 8964, 6133,
        6369, 4285, 5805, 9845, 6771, 3036, 9989, 8959, 2723, 3951,
        4496, 5011, 8764, 6213, 4675, 2003, 1917, 9504, 8381, 9899,
        7100, 4194, 2027, 2946, 419, 5892, 8654, 2680, 278, 5011,
        2616, 7230, 8394, 70, 9124, 2439, 6998, 9041, 1432, 8184,
        8308, 6818, 6276, 7715, 4070, 3188, 9567, 7050, 3898, 4060,
        8673, 4908, 8283, 4594, 8630, 4008, 8663, 4938, 7286, 5382,
        9439, 996, 7522, 6250, 1955, 4366, 4715, 308, 2063, 8448,
        112, 4486, 9330, 2207, 4777, 7704, 5693, 67, 8610, 2282,
        750, 5010, 1755, 7706, 3871, 7684, 5960, 472, 2127, 6202,
        8881, 2856, 4250, 4794, 7265, 1022, 6980, 4726, 296, 2524,
        3633, 8659, 8888, 7072, 7670, 6414, 9380, 6779, 9551, 6438,
        2370, 2686, 1213, 4587, 3892, 492, 3927, 7933, 254, 8959,
    };

void intercala(int inicio, int meio, int fim, int v[], int tam){
    int inicio_v1 = inicio;
    int inicio_v2 = meio+1;
    int pos_livre = 0;
    int aux[tam];

    while(inicio_v1<=meio && inicio_v2<=fim){
        if(v[inicio_v1] <= v[inicio_v2])
            aux[pos_livre++] = v[inicio_v1++];
        else
            aux[pos_livre++] = v[inicio_v2++];
    }

    while(inicio_v1 <= meio)
        aux[pos_livre++] = v[inicio_v1++];

    while(inicio_v2 <= fim)
        aux[pos_livre++] = v[inicio_v2++];

    for(inicio_v1 = inicio; inicio_v1 <= fim; inicio_v1++)
        v[inicio_v1] = aux[inicio_v1-inicio];
}

void mergeSort(int inicio, int fim, int v[], int tam){
    if(inicio<fim){
        int meio = (inicio+fim)/2;
        mergeSort(inicio, meio,v, tam);
        mergeSort(meio+1, fim, v, tam);
        intercala(inicio, meio, fim, v, tam);
    }
}

void executar(int tam, int caso, FILE *f){
    double tempos_execucao[1000];

    for(int j=0; j<1000; j++){
        int v[tam];
        clock_t inicio, fim;
        double tempo;

        for(int i=0; i<tam; i++){
            if (caso == 1){
                v[i] = i;
            }
            else if (caso == 2){
                /*int min = 1;
                int max = tam;
                v[i] = min + rand() % (max - min + 1);*/

                v[i] = vetor_fixo2[i];
            }
            else if (caso == 3){
                v[i] = tam - i;
            }
        }

        inicio = clock();
        mergeSort(0, tam-1, v, tam);
        fim = clock();

        tempo = ((double)(fim - inicio)) / CLOCKS_PER_SEC;
        tempos_execucao[j] = tempo;
    }

    const char *nome_caso;
    if (caso == 1) nome_caso = "Melhor";
    else if (caso == 2) nome_caso = "Caso medio";
    else nome_caso = "Pior";

    for(int i=0; i<1000; i++){
        fprintf(f, "%s,%d,%d,%.9f\n", nome_caso, tam, i+1, tempos_execucao[i]);
    }
}

int main(void){
    FILE *f = fopen("tempos_c.csv", "w");
    if(f == NULL){
        printf("Erro ao abrir arquivo para escrita\n");
        return 1;
    }

    fprintf(f, "Caso,Tamanho,Execucao,Tempo\n");

    executar(100, 1, f);
    executar(100, 2, f);
    executar(100, 3, f);

    
    executar(1000, 1, f);
    executar(1000, 2, f);
    executar(1000, 3, f);

    /*
    executar(10000, 1, f);
    executar(10000, 2, f);
    executar(10000, 3, f);
    */
    fclose(f);
    return 0;
}